# Haim Clicker

## Обзор проекта

Веб-приложение для определения скидки пользователя в магазине «Аба Хаим». Скидка рассчитывается на основе точности нажатия кнопки – зафиксированное время должно быть максимально приближено к целой секунде (с измерением в миллисекундах).

### Целевая аудитория
- Конечные пользователи, участвующие в игре через браузеры (десктоп и мобильные устройства)
- Администраторы и сотрудники магазина для управления игрой и обработки результатов

## Функциональные возможности

### Пользовательский интерфейс и игровой процесс
- Отображение текущего времени с точностью до миллисекунд
- Игровая кнопка для фиксации времени с блокировкой на 500 мс после каждого нажатия
- Таблица результатов с отображением попыток, времени нажатия, отклонения и скидки
- Правила игры в модальном окне
- Контактные данные магазина
- Политика конфиденциальности

### Игровая логика
- 10 попыток для каждого пользователя
- Расчет скидки на основе лучшей попытки (минимальное отклонение от целой секунды)
- Таблица диапазонов скидок:
  - 0 мс: 25%
  - 1-10 мс: 15%
  - 11-50 мс: 10%
  - 51-100 мс: 5%
  - >100 мс: 3%

### Регистрация и вход
- Форма регистрации с полями: имя, номер телефона
- Вход по номеру телефона
- Проверка наличия пользователя в базе

### Административная панель
- Управление игрой: сброс попыток, изменение количества попыток, изменение диапазонов скидок
- Просмотр и экспорт данных пользователей
- Логирование действий администратора

## Технический стек

### Основной стек
- **Supabase**:
  - PostgreSQL для хранения данных
  - Supabase Auth для управления аутентификацией
  - Row Level Security (RLS)
- **Фронтенд**:
  - Vite + React + TypeScript
  - Tailwind CSS
  - React Router
  - React Hook Form
  - UI-библиотеки для модальных окон и уведомлений
- **Дополнительные библиотеки**:
  - Axios
  - date-fns
  - exceljs

## Установка и запуск

### Требования
- Node.js (версия 18 или выше)
- npm или yarn

### Установка
```bash
# Клонирование репозитория
git clone https://github.com/your-username/haim-clicker.git
cd haim-clicker

# Установка зависимостей
npm install
# или
yarn install
```

### Настройка переменных окружения
Создайте файл `.env` в корне проекта и добавьте следующие переменные:
```
VITE_SUPABASE_URL=ваш_url_supabase
VITE_SUPABASE_ANON_KEY=ваш_анонимный_ключ_supabase
```

### Запуск в режиме разработки
```bash
npm run dev
# или
yarn dev
```

### Сборка для продакшена
```bash
npm run build
# или
yarn build
```

## Структура проекта
```
/
├── src/
│   ├── components/
│   │   ├── Game.tsx                # Компонент игрового процесса
│   │   ├── AdminPanel.tsx          # Компонент административной панели
│   │   ├── Login.tsx               # Страница входа/регистрации
│   │   └── ModalRules.tsx          # Модальное окно с правилами игры
│   ├── hooks/
│   │   ├── useTimer.ts             # Хук для таймера (с точностью до миллисекунд)
│   │   ├── useSupabase.ts          # Хук для аутентификации и работы с Supabase
│   │   └── useLocalStorage.ts      # Хук для работы с localStorage
│   ├── types/
│   │   ├── user.ts                 # Типы для пользователей
│   │   ├── attempt.ts              # Типы для попыток
│   │   └── settings.ts             # Типы для настроек игры
│   ├── utils/
│   │   ├── timeUtils.ts            # Утилиты для работы со временем
│   │   └── formatUtils.ts          # Утилиты для форматирования данных
│   ├── supabase/
│   │   └── client.ts               # Инициализация клиента Supabase
│   ├── App.tsx                     # Основной компонент приложения
│   ├── main.tsx                    # Точка входа
│   └── index.css                   # Стили (TailwindCSS)
├── supabase/
│   └── migrations/                 # SQL миграции для создания таблиц
├── package.json                    # Зависимости проекта
└── README.md                       # Документация и инструкции
```

## Безопасность
- Аутентификация через Supabase Auth
- Защита от автокликеров (блокировка кнопки на 500 мс)
- Блокировка входа администратора после 5 неудачных попыток
- Безопасное хранение и передача данных через HTTPS
- Политика обработки персональных данных

## Локализация
- Основной язык интерфейса: русский
- Форматы дат и чисел соответствуют российским стандартам

## Мониторинг и аналитика
- Интеграция с Google Analytics
- Экспорт данных в формате Excel

## Деплой и хостинг
- Фронтенд: Replit
- Бэкенд и база данных: Supabase (бесплатный тариф для MVP)